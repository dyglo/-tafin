Phase 0 â€“ Pre-Development Notes
================================

Project Overview
----------------
- The project (now branded TAFIN) began as an autonomous financial research agent with a legacy name; functionality centres on planning, execution, validation, and answer synthesis.
- Interactive usage is provided through a Python CLI (`uv run tafin`) with an optional Node wrapper binary.
- Core flow layers: planning, tool selection, validation, and answer generation with structured logging and progress UI.

Project Structure (pre-rebrand snapshot)
---------------------------------------
- `src/tafin/agent.py` (formerly `src/<legacy>/agent.py`): orchestrates the multi-step workflow with safeguards against runaway loops.
- `src/tafin/model.py`: wraps `ChatOpenAI` (`gpt-4o`) with optional structured outputs/tool binding.
- `src/tafin/tools.py`: defines FinancialDatasets, Serper (search), and Alpha Vantage helper tools using environment-provided API keys.
- `src/tafin/prompts.py`: system prompts for planner, executor, validator, and answer generator.
- `src/tafin/utils/intro.py`: CLI intro banner and welcome copy.
- `src/tafin/utils/logger.py`: logging helper built on the UI utilities.
- `src/tafin/utils/ui.py`: progress spinners and console formatting (contains legacy box-drawing artefacts to clean up).
- `src/tafin/cli.py`: CLI entry point (loads `.env`, prints intro, runs REPL with custom prompt).
- `pyproject.toml`: Python package metadata (`name = "tafin"`) and console entry points.
- `package.json` & `index.js`: Node wrapper exposing the CLI through npm.
- `env.example`: documents required API keys (`TAFIN_*` with fallbacks for legacy variables).
- `uv.lock`: lock file for dependencies (contains numerous legacy-string references generated by uv).

Dependencies
------------
- Python runtime: `langchain`, `langchain-openai`, `openai`, `prompt-toolkit`, `pydantic`, `python-dotenv`, `requests`.
- External services: OpenAI (`TAFIN_OPENAI_API_KEY` or `OPENAI_API_KEY`), FinancialDatasets (`TAFIN_FINANCIAL_DATASETS_API_KEY`), Serper (`TAFIN_SERPER_API_KEY`), and Alpha Vantage (`TAFIN_ALPHA_VANTAGE_API_KEY`).
- Node wrapper relies on shelling out to the Python CLI binary.

Existing API Integrations
-------------------------
- **OpenAI ChatGPT (gpt-4o)** for planning, tool reasoning, validation, and answer synthesis.
- **FinancialDatasets API** (`https://api.financialdatasets.ai`) for income, balance sheet, and cash flow statements via `x-api-key` header.
- **Serper (Google Search)** (`https://google.serper.dev/search`) for web intelligence lookups.
- **Alpha Vantage** (`https://www.alphavantage.co/query`) for market prices and company overview data.

Branding Audit (pre-change)
---------------------------
- Source modules, prompts, intro banner, logger strings, README, package metadata, and lock file all used the legacy name.
- No dedicated `DEXTER_*` environment variables existed; keys used vendor-specific names.
- PlanUpdate.md (project plan) retains historical wording for task tracking.

Rebrand Considerations (addressed/queued)
-----------------------------------------
- Rename Python package directory and update all imports.
- Replace console banner, prompts, and CLI prompt with TAFIN language.
- Align project metadata (`pyproject.toml`, `package.json`, Node wrapper).
- Update documentation to describe the TAFIN brand and new CLI command.
- Prefer `TAFIN_*` environment variables while honouring legacy fallbacks.
- Sweep logs and utilities to remove legacy wording and corrupted characters.

Open Questions / Risks
----------------------
- `uv.lock` still contains generated references to the legacy name; decide whether to regenerate or accept remaining mentions.
- `utils.ui` includes non-ASCII characters from earlier tooling; requires cleanup while preserving styling intent.
